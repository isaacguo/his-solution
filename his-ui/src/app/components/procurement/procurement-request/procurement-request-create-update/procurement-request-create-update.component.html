<div class="row">
  <h1 class="page-header text-center">
    采购申请单
  </h1>
</div>

<modal #confirmCreateModal (onClose)="onConfirmCreateModalClosed()">
  <form #modalForm1="ngForm">
    <modal-header [show-close]="true">
      <h4 class="modal-title">信息</h4>
    </modal-header>
    <modal-body>
      {{requestCreationResultText}}
    </modal-body>
    <modal-footer>
      <button type="button" class="btn btn-primary" (click)="confirmCreateModal.close()">确定</button>
    </modal-footer>
  </form>
</modal>

<form [formGroup]="formModel" novalidate (ngSubmit)="onSubmit()">

  <input type="hidden" formControlName="id">

  <div class="panel panel-info" formGroupName="vendorInfo">
    <div class="panel-heading">
      <div>
        <span>供应商信息</span>
      </div>
    </div>
    <!-- Angular assigns array index as group name by default 0, 1, 2, ... -->
    <div class="panel-body">
      <div class="row"></div>
      <div class="col-md-4 form-group">
        <label>供应商名称</label>
        <span color="red" class="text-danger" [hidden]="vendorInfo.controls.vendorName.valid">*</span>
        <input class="form-control" type="text" formControlName="vendorName">
        <small [hidden]="vendorInfo.controls.vendorName.valid" class="text-danger">
          供应商名称不能为空
        </small>
      </div>
      <div class="col-md-4 form-group">
        <label>联系人</label><span color="red" class="text-danger"
                                [hidden]="vendorInfo.controls.contact.valid">*</span>
        <input class="form-control" type="text" formControlName="contact">
        <small [hidden]="vendorInfo.controls.contact.valid" class="text-danger">
          联系人不能为空
        </small>
      </div>
      <div class="col-md-4 form-group">
        <label>联系人电话</label><span color="red" class="text-danger"
                                  [hidden]="vendorInfo.controls.contactTelephone.valid">*</span>
        <input class="form-control" type="text" formControlName="contactTelephone">
        <small [hidden]="vendorInfo.controls.contactTelephone.valid" class="text-danger">
          联系人电话不能为空
        </small>
      </div>
    </div>
  </div>

  <div>
    <div formArrayName="goods">
      <div>
        <div class="panel panel-info">
          <div class="panel-heading">
            <div>
              <span><b>申请采购商品或服务</b></span>
            </div>
          </div>
          <div class="panel-body">
            <table class="table table-bordered">
              <thead>
              <tr>
                <td>序号</td>
                <td>产品名称</td>
                <td>包装规格</td>
                <td>包装单位</td>
                <td>数量</td>
                <td>单价</td>
                <td>总价</td>
                <td>操作</td>
              </tr>
              </thead>
              <tbody>

              <tr *ngFor="let good of goodsData.controls; let i=index" [formGroupName]="i">
                <td>{{i+1}}</td>
                <td><input class="form-control" type="text" formControlName="name"><small [hidden]="good.controls.name.valid" class="text-danger">
                  产品名称不能为空
                </small></td>
                <td><input class="form-control" type="text" formControlName="packageSpecification"><small [hidden]="good.controls.packageSpecification.valid" class="text-danger">
                  包装规格不能为空
                </small></td>
                <td><input class="form-control" type="text" formControlName="packageUnit"><small [hidden]="good.controls.packageUnit.valid" class="text-danger">
                  包装单位不能为空
                </small></td>
                <td><input (change)="onValueChanged(i)" class="form-control" type="text" formControlName="number"><small [hidden]="good.controls.number.valid" class="text-danger">
                  数量不能为空
                </small></td>
                <td><input (change)="onValueChanged(i)"  class="form-control" type="text" formControlName="pricePerUnit">
                  <small [hidden]="good.controls.pricePerUnit.valid" class="text-danger">
                    单价不能为空
                  </small></td>
                <td><input class="form-control" type="text" formControlName="totalPrice">
                </td>
                <td><span class="glyphicon glyphicon-remove"
                          (click)="removeGood(i)">
                </span></td>

              </tr>

              </tbody>
            </table>
            <div class="isaac-margin-top">
              <a (click)="addGood()" style="cursor: default">
                添加新商品 +
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div>
    <div>
      <div class="panel panel-info">
        <div class="panel-heading">
          <div>
            <span><b>采购说明</b></span>
          </div>
        </div>
        <div class="panel-body">
          <textarea rows="10" class="form-control" formControlName="explanation"></textarea>

        </div>
      </div>
    </div>
  </div>



  <button class="btn btn-primary isaac-margin-15top" type="submit" [disabled]="!formModel.valid">确认</button>

</form>


